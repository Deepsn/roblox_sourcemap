import React, { FunctionComponent } from "react";
import classNames from "classnames";
import useVerifiedBadgeStyles from "../styles/VerifiedBadge.styles";
import { BadgeSizes } from "../constants/BadgeConstants";
import { noop, bindKeyDownA11yButton } from "../utils/misc";

export interface DataAttrs {
  [index: string]: string;
}

export interface BadgeIconProps {
  size: BadgeSizes;
  src: string;
  titleText: string;
  additionalContainerClass?: string;
  overrideContainerClass?: string;
  additionalImgClass?: string;
  overrideImgClass?: string;
  dataAttrs?: DataAttrs;
  onIconClick?: () => void;
}

export const BadgeIcon: FunctionComponent<BadgeIconProps> = ({
  size,
  src,
  titleText,
  additionalContainerClass,
  overrideContainerClass,
  additionalImgClass,
  overrideImgClass,
  dataAttrs = {},
  onIconClick = noop,
}) => {
  if (!size) {
    throw new Error("Must provide a size prop");
  }

  if (!titleText) {
    throw new Error("Must provide a titleText for accessibility");
  }

  if (!src) {
    throw new Error("Must provide a src prop");
  }

  const { iconImg = "", imgWrapper = "" } =
    useVerifiedBadgeStyles(size).classes;
  const wrapperClass =
    overrideContainerClass || classNames(additionalContainerClass, imgWrapper);
  const imgClass =
    overrideImgClass || [additionalImgClass, iconImg].join(" ") || "";
  const onKeyDownHandler = bindKeyDownA11yButton(onIconClick);

  return (
    <span
      role="button"
      tabIndex={0}
      {...dataAttrs}
      data-rblx-badge-icon
      className={wrapperClass}
      onClick={onIconClick}
      onKeyDown={onKeyDownHandler}
    >
      <img className={imgClass} src={src} title={titleText} alt={titleText} />
    </span>
  );
};

export default BadgeIcon;
