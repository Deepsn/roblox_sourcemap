import*as e from"react";import{jsx as n}from"react/jsx-runtime";function t(e,n){if("function"==typeof e)return e(n);null!=e&&(e.current=n)}function r(...e){return n=>{let r=!1;const o=e.map((e=>{const o=t(e,n);return r||"function"!=typeof o||(r=!0),o}));if(r)return()=>{for(let n=0;n<o.length;n++){const r=o[n];"function"==typeof r?r():t(e[n],null)}}}}function o(...n){return e.useCallback(r(...n),n)}function u(t,r=[]){let o=[];const u=()=>{const n=o.map((n=>e.createContext(n)));return function(r){const o=r?.[t]||n;return e.useMemo((()=>({[`__scope${t}`]:{...r,[t]:o}})),[r,o])}};return u.scopeName=t,[function(r,u){const i=e.createContext(u),s=o.length;o=[...o,u];const c=r=>{const{scope:o,children:u,...c}=r,a=o?.[t]?.[s]||i,f=e.useMemo((()=>c),Object.values(c));return n(a.Provider,{value:f,children:u})};return c.displayName=r+"Provider",[c,function(n,o){const c=o?.[t]?.[s]||i,a=e.useContext(c);if(a)return a;if(void 0!==u)return u;throw new Error(`\`${n}\` must be used within \`${r}\``)}]},i(u,...r)]}function i(...n){const t=n[0];if(1===n.length)return t;const r=()=>{const r=n.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(n){const o=r.reduce(((e,{useScope:t,scopeName:r})=>({...e,...t(n)[`__scope${r}`]})),{});return e.useMemo((()=>({[`__scope${t.scopeName}`]:o})),[o])}};return r.scopeName=t.scopeName,r}function s(e,n,{checkForDefaultPrevented:t=!0}={}){return function(r){if(e?.(r),!1===t||!r.defaultPrevented)return n?.(r)}}function c(n){const t=e.useRef(n);return e.useEffect((()=>{t.current=n})),e.useMemo((()=>(...e)=>t.current?.(...e)),[])}function a({prop:n,defaultProp:t,onChange:r=(()=>{})}){const[o,u]=function({defaultProp:n,onChange:t}){const r=e.useState(n),[o]=r,u=e.useRef(o),i=c(t);return e.useEffect((()=>{u.current!==o&&(i(o),u.current=o)}),[o,u,i]),r}({defaultProp:t,onChange:r}),i=void 0!==n,s=i?n:o,a=c(r);return[s,e.useCallback((e=>{if(i){const t="function"==typeof e?e(n):e;t!==n&&a(t)}else u(e)}),[i,n,u,a])]}var f=Boolean(globalThis?.document)?e.useLayoutEffect:()=>{};function l(n){const[t,r]=e.useState(void 0);return f((()=>{if(n){r({width:n.offsetWidth,height:n.offsetHeight});const e=new ResizeObserver((e=>{if(!Array.isArray(e))return;if(!e.length)return;const t=e[0];let o,u;if("borderBoxSize"in t){const e=t.borderBoxSize,n=Array.isArray(e)?e[0]:e;o=n.inlineSize,u=n.blockSize}else o=n.offsetWidth,u=n.offsetHeight;r({width:o,height:u})}));return e.observe(n,{box:"border-box"}),()=>e.unobserve(n)}r(void 0)}),[n]),t}var d=n=>{const{present:t,children:r}=n,u=function(n){const[t,r]=e.useState(),o=e.useRef({}),u=e.useRef(n),i=e.useRef("none"),s=n?"mounted":"unmounted",[c,a]=function(n,t){return e.useReducer(((e,n)=>t[e][n]??e),n)}(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return e.useEffect((()=>{const e=m(o.current);i.current="mounted"===c?e:"none"}),[c]),f((()=>{const e=o.current,t=u.current;if(t!==n){const r=i.current,o=m(e);if(n)a("MOUNT");else if("none"===o||"none"===e?.display)a("UNMOUNT");else{a(t&&r!==o?"ANIMATION_OUT":"UNMOUNT")}u.current=n}}),[n,a]),f((()=>{if(t){let e;const n=t.ownerDocument.defaultView??window,r=r=>{const i=m(o.current).includes(r.animationName);if(r.target===t&&i&&(a("ANIMATION_END"),!u.current)){const r=t.style.animationFillMode;t.style.animationFillMode="forwards",e=n.setTimeout((()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=r)}))}},s=e=>{e.target===t&&(i.current=m(o.current))};return t.addEventListener("animationstart",s),t.addEventListener("animationcancel",r),t.addEventListener("animationend",r),()=>{n.clearTimeout(e),t.removeEventListener("animationstart",s),t.removeEventListener("animationcancel",r),t.removeEventListener("animationend",r)}}a("ANIMATION_END")}),[t,a]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:e.useCallback((e=>{e&&(o.current=getComputedStyle(e)),r(e)}),[])}}(t),i="function"==typeof r?r({present:u.isPresent}):e.Children.only(r),s=o(u.ref,function(e){let n=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=n&&"isReactWarning"in n&&n.isReactWarning;if(t)return e.ref;if(n=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=n&&"isReactWarning"in n&&n.isReactWarning,t)return e.props.ref;return e.props.ref||e.ref}(i));return"function"==typeof r||u.isPresent?e.cloneElement(i,{ref:s}):null};function m(e){return e?.animationName||"none"}d.displayName="Presence";export{d as P,u as a,a as b,r as c,s as d,l as e,c as f,f as g,o as u};
